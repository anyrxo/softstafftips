<script>
  const apiUrl = 'https://gist.githubusercontent.com/xsirenmedia/ba691cca7192cf40ceddad1b2ededfea/raw/9e37397b3727df47992772f70113681b773545ac/gistfile1.txt';
  let tips = [];
  let currentIndex = 0;

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  async function fetchTips() {
    try {
      console.log('Fetching tips from GitHub Gist...');
      const response = await fetch(apiUrl);

      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }

      const text = await response.text();
      tips = JSON.parse(text);
      console.log('Fetched tips:', tips);

      if (!Array.isArray(tips) || tips.length === 0) {
        console.error('No valid tips found.');
        return;
      }

      shuffleArray(tips); // Shuffle tips initially
      startScrolling();
    } catch (error) {
      console.error('Failed to load tips:', error);
    }
  }

  function startScrolling() {
    const container = document.getElementById('scroll-container');
    console.log('Container element:', container); // Debug log

    if (!container) {
      console.error('Container element not found');
      return;
    }

    function addNextMessage() {
      container.innerHTML = ''; // Clear old message

      const tip = tips[currentIndex];
      currentIndex++;

      if (currentIndex >= tips.length) {
        shuffleArray(tips);
        currentIndex = 0;
      }

      const messageDiv = document.createElement('div');
      messageDiv.className = 'scroll-message';
      messageDiv.innerHTML = `
        <div>
          <strong>${tip.title}</strong>: ${tip.description}
        </div>
      `;

      container.appendChild(messageDiv);

      setTimeout(addNextMessage, 4000); // Wait 4 seconds before next message
    }

    addNextMessage(); // Start the first message
  }

  // Polling function to wait for #scroll-container to exist
  function waitForContainer() {
    const container = document.getElementById('scroll-container');
    if (container) {
      console.log('Container element found');
      fetchTips(); // Start fetching tips and scrolling
    } else {
      console.log('Waiting for container element...');
      setTimeout(waitForContainer, 100); // Check again after 100ms
    }
  }

  // Start polling for #scroll-container
  waitForContainer();
</script>
